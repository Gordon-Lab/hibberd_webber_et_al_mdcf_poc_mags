#Mann-Whitney test on CAMI data

library(dplyr)
library(apeglm)
library(fgsea)
library(boot)
library(RColorBrewer)
library(ggpubr)

####Script to analyze the results from the CAMI contig binning and AMBER analysis

#Read in table that has results of metrics for bins generated by the given method (AMBER output)
setwd("~/Box/Gordon_Lab/Gordon_Lab/2021/CAMI_letter/genome/DASTool_Bowtie")

DAS_bowtie <- read.table("metrics_per_bin.tsv", header=TRUE, sep='\t')
#540 bins by 13 metrics

#Adjust column names
colnames(DAS_bowtie) <- gsub("_bowtie", "", colnames(DAS_bowtie))
colnames(DAS_bowtie) <- gsub("__", "_", colnames(DAS_bowtie))
colnames(DAS_bowtie) <- gsub("bp_", "bp", colnames(DAS_bowtie))

#REad in additional table for kallisto method
setwd("~/Box/Gordon_Lab/Gordon_Lab/2021/CAMI_letter/genome/DASTool_Kallisto")

DAS_kallisto <- read.table("metrics_per_bin.tsv", header=TRUE, sep='\t')

#Adjust column names
colnames(DAS_kallisto) <- gsub("_kallisto", "", colnames(DAS_kallisto))
colnames(DAS_kallisto) <- gsub("__", "_", colnames(DAS_kallisto))
colnames(DAS_kallisto)==colnames(DAS_bowtie)

#Add in column indicating which methods the bins were generated from
DAS_kallisto$Method <- c("DASTool_Kallisto")
DAS_bowtie$Method <- c("DASTool_Bowtie")

#Combine outputs
both_methods <- rbind(DAS_kallisto, DAS_bowtie)

#See which metrics were measured for the various bins
colnames(both_methods)
#[1] "sample_id"                             "Bin_ID"                                "Most_abundant_genome"                 
#[4] "Purity_bp"                             "Completeness_bp"                       "Bin_size_bp"                          
#[7] "True_positives_bp"                     "True_size_of_most_abundant_genome_bp"  "Purity_seq"                           
#[10] "Completeness_seq"                      "Bin_size_seq"                          "True_positives_seq"                   
#[13] "True_size_of_most_abundant_genome_seq" "method" 

#####################################################################################################################################

#Plot the metrics, run wilcox test on the data
p <- ggboxplot(both_methods, x = "Method", y = "Purity_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=0.5)

#Determine the mean and SD values for the metric of interest
aggregate(x = both_methods$Purity_bp,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Purity_bp,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

#####################################################################################################################################

#Plot the metrics, run wilcox test on the data
p <- ggboxplot(both_methods, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

#Determine the mean and SD values for the metric of interest
aggregate(x = both_methods$Completeness_bp,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Completeness_bp,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

#####################################################################################################################################
#Plot the metrics, run wilcox test on the data
p <- ggboxplot(both_methods, x = "Method", y = "Bin_size_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Bin_size_bp,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Bin_size_bp,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

#####################################################################################################################################

#Plot the metrics, run wilcox test on the data
p <- ggboxplot(both_methods, x = "Method", y = "True_positives_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

#Determine the mean and SD values for the metric of interest
aggregate(x = both_methods$True_positives_bp,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True_positives_bp,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

#####################################################################################################################################

#Plot the metrics, run wilcox test on the data
p <- ggboxplot(both_methods, x = "Method", y = "True_size_of_most_abundant_genome_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

#Determine the mean and SD values for the metric of interest
aggregate(x = both_methods$True_size_of_most_abundant_genome_bp,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True_size_of_most_abundant_genome_bp,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

#####################################################################################################################################
#Plot the metrics, run wilcox test on the data
p <- ggboxplot(both_methods, x = "Method", y = "Purity_seq", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

#Determine the mean and SD values for the metric of interest
aggregate(x = both_methods$Purity_seq,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Purity_seq,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

#####################################################################################################################################
#Plot the metrics, run wilcox test on the data
p <- ggboxplot(both_methods, x = "Method", y = "Completeness_seq", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

#Determine the mean and SD values for the metric of interest
aggregate(x = both_methods$Completeness_seq,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Completeness_seq,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

#####################################################################################################################################
#Plot the metrics, run wilcox test on the data
p <- ggboxplot(both_methods, x = "Method", y = "Bin_size_seq", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

#Determine the mean and SD values for the metric of interest
aggregate(x = both_methods$Bin_size_seq,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Bin_size_seq,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

#####################################################################################################################################
#Plot the metrics, run wilcox test on the data
p <- ggboxplot(both_methods, x = "Method", y = "True_positives_seq", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

#Determine the mean and SD values for the metric of interest
aggregate(x = both_methods$True_positives_seq,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True_positives_seq,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

#####################################################################################################################################
#Plot the metrics, run wilcox test on the data
p <- ggboxplot(both_methods, x = "Method", y = "True_size_of_most_abundant_genome_seq", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

#Determine the mean and SD values for the metric of interest
aggregate(x = both_methods$True_size_of_most_abundant_genome_seq,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True_size_of_most_abundant_genome_seq,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

#####################################################################################################################################
#Isolate bins passing a certain purity and completeness threshold

complete_90_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.90)

#Determine the number of bins from each method passing that metric
table(complete_90_contam_5$Method)

#Isolate bins passing a certain purity and completeness threshold
complete_70_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.70)

#Determine the number of bins from each method passing that metric
table(complete_70_contam_5$Method)

#Isolate bins passing a certain purity and completeness threshold
complete_50_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.50)

#Determine the number of bins from each method passing that metric
table(complete_50_contam_5$Method)

#Isolate bins passing a certain purity and completeness threshold
complete_90_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.90)

#Determine the number of bins from each method passing that metric
table(complete_90_contam_10$Method)

#Isolate bins passing a certain purity and completeness threshold
complete_70_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.70)

#Determine the number of bins from each method passing that metric
table(complete_70_contam_10$Method)

#Isolate bins passing a certain purity and completeness threshold
complete_50_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.50)

#Determine the number of bins from each method passing that metric
table(complete_50_contam_10$Method)

###############################################################################################################################
#Plot results and determine mean and SD for metrics of interest:

p <- ggboxplot(complete_90_contam_5, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

p <- ggboxplot(complete_90_contam_5, x = "Method", y = "Purity_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = complete_90_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = sd) 

aggregate(x = complete_90_contam_5$Purity_bp,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_5$Purity_bp,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = sd) 

###############################################################################################################################
#Plot results and determine mean and SD for metrics of interest:

complete_70_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.70)

table(complete_70_contam_5$Method)

p <- ggboxplot(complete_70_contam_5, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = complete_70_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_70_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_5$Method),              # Specify group indicator
          FUN = sd) 

###############################################################################################################################
#Plot results and determine mean and SD for metrics of interest:

complete_50_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.50)

aggregate(x = complete_50_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_50_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_5$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_50_contam_5, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

###############################################################################################################################
#Plot results and determine mean and SD for metrics of interest:

complete_90_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.90)

aggregate(x = complete_90_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_90_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_90_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_90_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

###############################################################################################################################
#Plot results and determine mean and SD for metrics of interest:

complete_70_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.70)

aggregate(x = complete_70_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_70_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_70_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

###############################################################################################################################
#Plot results and determine mean and SD for metrics of interest:

complete_50_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.50)

aggregate(x = complete_50_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_50_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_50_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

######################################################################################################################################
#Repeat as above, except now using different binning strategy:

setwd("~/Box/Gordon_Lab/Gordon_Lab/2021/CAMI_letter/genome/MaxBin2_Bowtie/")

maxbin2_bowtie <- read.table("metrics_per_bin.tsv", header=TRUE, sep='\t')

setwd("~/Box/Gordon_Lab/Gordon_Lab/2021/CAMI_letter/genome/MaxBin2_Kallisto")

maxbin2_kallisto <- read.table("metrics_per_bin.tsv", header=TRUE, sep='\t')


maxbin2_kallisto$Method <- c("maxbin2_Kallisto")
maxbin2_bowtie$Method <- c("maxbin2_Bowtie")

both_methods <- rbind(maxbin2_kallisto, maxbin2_bowtie)

colnames(both_methods)
#[1] "sample_id"                               "Bin.ID"                                  "Most.abundant.genome"                   
#[4] "Purity..bp."                             "Completeness..bp."                       "Bin.size..bp."                          
#[7] "True.positives..bp."                     "True.size.of.most.abundant.genome..bp."  "Purity..seq."                           
#[10] "Completeness..seq."                      "Bin.size..seq."                          "True.positives..seq."                   
#[13] "True.size.of.most.abundant.genome..seq." "Method" 

p <- ggboxplot(both_methods, x = "Method", y = "Purity..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=0.5)

aggregate(x = both_methods$Purity..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Purity..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

kallisto_purity <- both_methods %>%
  filter(Method=="maxbin2_Kallisto") %>%
  select(Purity..bp.)

p <- ggboxplot(both_methods, x = "Method", y = "Completeness..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Completeness..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Completeness..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "Bin.size..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Bin.size..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Bin.size..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "True.positives..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$True.positives..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.positives..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "True.size.of.most.abundant.genome..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$True.size.of.most.abundant.genome..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.size.of.most.abundant.genome..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "Purity..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Purity..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Purity..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "Completeness..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Completeness..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Completeness..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "Bin.size..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Bin.size..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Bin.size..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "True.positives..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$True.positives..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.positives..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "True.size.of.most.abundant.genome..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)


aggregate(x = both_methods$True.size.of.most.abundant.genome..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.size.of.most.abundant.genome..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

complete_90_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.90)

table(complete_90_contam_5$Method)

complete_70_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.70)

table(complete_70_contam_5$Method)

complete_50_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.50)

table(complete_50_contam_5$Method)

complete_90_contam_10 <- both_methods %>%
  filter(Purity..bp. > 0.90 & Completeness..bp. > 0.90)

table(complete_90_contam_10$Method)

complete_70_contam_10 <- both_methods %>%
  filter(Purity..bp. > 0.90 & Completeness..bp. > 0.70)

table(complete_70_contam_10$Method)

complete_50_contam_10 <- both_methods %>%
  filter(Purity..bp. > 0.90 & Completeness..bp. > 0.50)

table(complete_50_contam_10$Method)


complete_90_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.90)

table(complete_90_contam_5$Method)

p <- ggboxplot(complete_90_contam_5, x = "Method", y = "Completeness..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

p <- ggboxplot(complete_90_contam_5, x = "Method", y = "Purity..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = complete_90_contam_5$Completeness..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_5$Completeness..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = sd) 

aggregate(x = complete_90_contam_5$Purity..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_5$Purity..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = sd) 


complete_70_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.70)

p <- ggboxplot(complete_70_contam_5, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = complete_70_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_70_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_5$Method),              # Specify group indicator
          FUN = sd) 


complete_50_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.50)

aggregate(x = complete_50_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_50_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_5$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_50_contam_5, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

complete_90_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.90)

aggregate(x = complete_90_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_90_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_90_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_90_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)


complete_70_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.70)

aggregate(x = complete_70_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_70_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_70_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

complete_50_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.50)

aggregate(x = complete_50_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_50_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_50_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

####################################################################################################################################

setwd("~/Box/Gordon_Lab/Gordon_Lab/2021/CAMI_letter/genome/METABAT2_Bowtie/")

metabat2_bowtie <- read.table("metrics_per_bin.tsv", header=TRUE, sep='\t')

setwd("~/Box/Gordon_Lab/Gordon_Lab/2021/CAMI_letter/genome/METABAT2_Kallisto")

metabat2_kallisto <- read.table("metrics_per_bin.tsv", header=TRUE, sep='\t')

metabat2_kallisto$Method <- c("metabat2_Kallisto")
metabat2_bowtie$Method <- c("metabat2_Bowtie")

both_methods <- rbind(metabat2_kallisto, metabat2_bowtie)

colnames(both_methods)
#[1] "sample_id"                               "Bin.ID"                                  "Most.abundant.genome"                   
#[4] "Purity..bp."                             "Completeness..bp."                       "Bin.size..bp."                          
#[7] "True.positives..bp."                     "True.size.of.most.abundant.genome..bp."  "Purity..seq."                           
#[10] "Completeness..seq."                      "Bin.size..seq."                          "True.positives..seq."                   
#[13] "True.size.of.most.abundant.genome..seq." "Method" 

p <- ggboxplot(both_methods, x = "Method", y = "Purity..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=0.5)

#Determine number of bins per method:
table(both_methods$Method)
#metabat2_Bowtie metabat2_Kallisto 
#578               925 

aggregate(x = both_methods$Purity..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Purity..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

kallisto_purity <- both_methods %>%
  filter(Method=="maxbin2_Kallisto") %>%
  select(Purity..bp.)

p <- ggboxplot(both_methods, x = "Method", y = "Completeness..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Completeness..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Completeness..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "Bin.size..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Bin.size..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Bin.size..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "True.positives..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$True.positives..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.positives..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "True.size.of.most.abundant.genome..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$True.size.of.most.abundant.genome..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.size.of.most.abundant.genome..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "Purity..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Purity..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Purity..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "Completeness..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Completeness..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Completeness..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "Bin.size..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Bin.size..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Bin.size..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "True.positives..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$True.positives..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.positives..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "True.size.of.most.abundant.genome..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)


aggregate(x = both_methods$True.size.of.most.abundant.genome..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.size.of.most.abundant.genome..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

complete_90_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.90)

table(complete_90_contam_5$Method)

complete_70_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.70)

table(complete_70_contam_5$Method)

complete_50_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.50)

table(complete_50_contam_5$Method)

complete_90_contam_10 <- both_methods %>%
  filter(Purity..bp. > 0.90 & Completeness..bp. > 0.90)

table(complete_90_contam_10$Method)

complete_70_contam_10 <- both_methods %>%
  filter(Purity..bp. > 0.90 & Completeness..bp. > 0.70)

table(complete_70_contam_10$Method)

complete_50_contam_10 <- both_methods %>%
  filter(Purity..bp. > 0.90 & Completeness..bp. > 0.50)

table(complete_50_contam_10$Method)

complete_90_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.90)

table(complete_90_contam_5$Method)

p <- ggboxplot(complete_90_contam_5, x = "Method", y = "Completeness..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

p <- ggboxplot(complete_90_contam_5, x = "Method", y = "Purity..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = complete_90_contam_5$Completeness..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_5$Completeness..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = sd) 

aggregate(x = complete_90_contam_5$Purity..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_5$Purity..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = sd) 


complete_70_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.70)

p <- ggboxplot(complete_70_contam_5, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = complete_70_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_70_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_5$Method),              # Specify group indicator
          FUN = sd) 


complete_50_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.50)

aggregate(x = complete_50_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_50_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_5$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_50_contam_5, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

complete_90_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.90)

aggregate(x = complete_90_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_90_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_90_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_90_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)


complete_70_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.70)

aggregate(x = complete_70_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_70_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_70_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

complete_50_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.50)

aggregate(x = complete_50_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_50_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_50_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

####################################################################################################################################

setwd("~/Box/Gordon_Lab/Gordon_Lab/2021/CAMI_letter/genome/CONCOCT_Bowtie//")

CONCOCT_bowtie <- read.table("metrics_per_bin.tsv", header=TRUE, sep='\t')
setwd("~/Box/Gordon_Lab/Gordon_Lab/2021/CAMI_letter/genome/CONCOCT_Kallisto")

CONCOCT_kallisto <- read.table("metrics_per_bin.tsv", header=TRUE, sep='\t')

CONCOCT_kallisto$Method <- c("CONCOCT_Kallisto")
CONCOCT_bowtie$Method <- c("CONCOCT_Bowtie")

both_methods <- rbind(CONCOCT_kallisto, CONCOCT_bowtie)

colnames(both_methods)
#[1] "sample_id"                               "Bin.ID"                                  "Most.abundant.genome"                   
#[4] "Purity..bp."                             "Completeness..bp."                       "Bin.size..bp."                          
#[7] "True.positives..bp."                     "True.size.of.most.abundant.genome..bp."  "Purity..seq."                           
#[10] "Completeness..seq."                      "Bin.size..seq."                          "True.positives..seq."                   
#[13] "True.size.of.most.abundant.genome..seq." "Method" 

p <- ggboxplot(both_methods, x = "Method", y = "Purity..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=0.5)

#Determine number of bins per method:
table(both_methods$Method)
#metabat2_Bowtie metabat2_Kallisto 
#578               925 

aggregate(x = both_methods$Purity..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Purity..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

kallisto_purity <- both_methods %>%
  filter(Method=="maxbin2_Kallisto") %>%
  select(Purity..bp.)

p <- ggboxplot(both_methods, x = "Method", y = "Completeness..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Completeness..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Completeness..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "Bin.size..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Bin.size..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Bin.size..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "True.positives..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$True.positives..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.positives..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "True.size.of.most.abundant.genome..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$True.size.of.most.abundant.genome..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.size.of.most.abundant.genome..bp.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "Purity..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Purity..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Purity..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "Completeness..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Completeness..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Completeness..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 


p <- ggboxplot(both_methods, x = "Method", y = "Bin.size..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$Bin.size..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$Bin.size..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "True.positives..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = both_methods$True.positives..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.positives..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(both_methods, x = "Method", y = "True.size.of.most.abundant.genome..seq.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)


aggregate(x = both_methods$True.size.of.most.abundant.genome..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = both_methods$True.size.of.most.abundant.genome..seq.,                # Specify data column
          by = list(both_methods$Method),              # Specify group indicator
          FUN = sd) 

complete_90_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.90)

complete_90_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.90)

table(complete_90_contam_5$Method)

complete_70_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.70)

table(complete_70_contam_5$Method)

complete_50_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.50)

table(complete_50_contam_5$Method)

complete_90_contam_10 <- both_methods %>%
  filter(Purity..bp. > 0.90 & Completeness..bp. > 0.90)

table(complete_90_contam_10$Method)

complete_70_contam_10 <- both_methods %>%
  filter(Purity..bp. > 0.90 & Completeness..bp. > 0.70)

table(complete_70_contam_10$Method)

complete_50_contam_10 <- both_methods %>%
  filter(Purity..bp. > 0.90 & Completeness..bp. > 0.50)

table(complete_50_contam_10$Method)

complete_90_contam_5 <- both_methods %>%
  filter(Purity..bp. > 0.95 & Completeness..bp. > 0.90)

table(complete_90_contam_5$Method)

table(complete_90_contam_5$Method)

p <- ggboxplot(complete_90_contam_5, x = "Method", y = "Completeness..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

p <- ggboxplot(complete_90_contam_5, x = "Method", y = "Purity..bp.", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = complete_90_contam_5$Completeness..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_5$Completeness..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = sd) 

aggregate(x = complete_90_contam_5$Purity..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_5$Purity..bp.,                # Specify data column
          by = list(complete_90_contam_5$Method),              # Specify group indicator
          FUN = sd) 


complete_70_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.70)

p <- ggboxplot(complete_70_contam_5, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

aggregate(x = complete_70_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_70_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_5$Method),              # Specify group indicator
          FUN = sd) 


complete_50_contam_5 <- both_methods %>%
  filter(Purity_bp > 0.95 & Completeness_bp > 0.50)

aggregate(x = complete_50_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_5$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_50_contam_5$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_5$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_50_contam_5, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

complete_90_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.90)

aggregate(x = complete_90_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_90_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_90_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_90_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_90_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)


complete_70_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.70)

aggregate(x = complete_70_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_70_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_70_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_70_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

complete_50_contam_10 <- both_methods %>%
  filter(Purity_bp > 0.90 & Completeness_bp > 0.50)

aggregate(x = complete_50_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_10$Method),              # Specify group indicator
          FUN = mean)   

aggregate(x = complete_50_contam_10$Completeness_bp,                # Specify data column
          by = list(complete_50_contam_10$Method),              # Specify group indicator
          FUN = sd) 

p <- ggboxplot(complete_50_contam_10, x = "Method", y = "Completeness_bp", color = "Method", palette = "jco", add = "jitter") + theme(legend.position = "none")
p + stat_compare_means(label = "p.signif", method = "wilcox.test", paired=FALSE) + stat_compare_means(method = "wilcox.test", paired=FALSE, label.y=1)

